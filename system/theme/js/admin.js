$&&$(function(){!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=15)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.localStorage,r=function(){try{return a.setItem("test","test"),a.removeItem("test"),!0}catch(e){return!1}}();t.localStorage=a,t.isLocalStorageAvailable=r},function(e,t,n){"use strict";function a(e,t){var n=e.find("animateTransform");n.length&&(t?(n[0].setAttribute("repeatCount","indefinite"),n[0].beginElement()):n[0].setAttribute("repeatCount","1"))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={mac:/Macintosh/.test(navigator.userAgent),iosdevice:/(iPad)|(iPhone)/.test(navigator.userAgent)}},function(e,t,n){"use strict";function a(e,t,n){var a=void 0,r={event:"keydown",target:document,prevent:!1};n=d(n,r),Array.isArray(e)?(a=[],c.default.mac||(e=e.map(function(e){return e.replace("Cmd","Ctrl")})),e.forEach(function(e){return a.push(i(e,t,n))})):(c.default.mac||(e=e.replace("Cmd","Ctrl")),a=i(e,t,n));var o="string"==typeof n.target?document.querySelector(n.target):n.target;Array.isArray(a)?a.forEach(function(a,r){f[e[r]]||(f[e[r]]=[]),o.addEventListener(n.event,a,!1),f[e[r]].push({event:n.event,elem:o,fn:t,realFn:a})}):(f[e]||(f[e]=[]),o.addEventListener(n.event,a,!1),f[e].push({event:n.event,elem:o,fn:t,realFn:a}))}function r(e,t,n){function a(e){f[e]&&f[e].slice().reverse().forEach(function(e,a,r){e.fn!==t||n.target&&e.elem!==n.target||(e.elem.removeEventListener(e.event,e.realFn,!1),r.splice(r.length-1-a,1))})}n=n||{},Array.isArray(e)?e.forEach(a):a(e)}function i(e,t,n){return e=l(e).split("+"),function(a){o(a,e)&&(t(a),n.prevent&&(a.preventDefault(),a.stopPropagation()))}}function o(e,t){var n=s(e.keyCode),a={enter:13},r={},i=["shift","ctrl","alt","cmd"],o=0;i.forEach(function(e){r[e]={wanted:!1,pressed:!1}}),e.shiftKey&&(r.shift.pressed=!0),e.ctrlKey&&(r.ctrl.pressed=!0),e.altKey&&(r.alt.pressed=!0),e.metaKey&&(r.cmd.pressed=!0);for(var l=0;l<t.length;l++){var d=t[l];i.indexOf(d)>-1?(o++,r[d].wanted=!0):(d.length>1&&a[d]===e.keyCode||n===d)&&o++}return t.length===o&&Object.keys(r).reduce(function(e,t){return e&&r[t].wanted===r[t].pressed},!0)}function s(e){switch(e){case 91:case 93:return"MetaKey";case 188:return",";case 190:return".";case 219:return"[";case 221:return"]";default:return String.fromCharCode(e).toLowerCase()}}function l(e){return e.toLowerCase().replace(/\s/g,"")}function d(e,t){if(e){for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.unbindKeys=t.bindKeys=void 0;var u=n(2),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f={};t.bindKeys=a,t.unbindKeys=r},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a(r).default}})},function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode("::selection { background: transparent; }")),b.forEach(function(a){function r(){function a(){function i(){e.selectionStart=r,e.selectionEnd=o,t.removeChild(n)}t.appendChild(n),setTimeout(i,10),(0,x.unbindKeys)(v,a,{target:e})}var r=e.selectionStart,o=e.selectionEnd,v=["Cmd+Z","Ctrl+Z"];if("inline"!==s||-1===e.value.substring(r,o).indexOf("\n")){var g=d({name:i,pattern:l,text:e.value,start:r,end:o,isConsequent:!0});console.log(g),g.isWrapped?m({name:i,pattern:l,elem:e,start:r,end:o,parsed:g,prefix:u,nextPrefix:c,suffix:f}):p({name:i,pattern:l,elem:e,start:r,end:o,parsed:g,prefix:u,nextPrefix:c,suffix:f}),(0,x.bindKeys)(v,a,{target:e}),$(e).on("input",function(){(0,x.unbindKeys)(v,a,{target:e})})}}var i=a.name,o=a.keys,s=a.type,l=a.regexp,d=a.parse,u=a.prefix,c=a.nextPrefix,f=a.suffix,p=a.wrap,m=a.unwrap;(0,x.bindKeys)(o,r,{target:e,prevent:!0})})}function i(e){var t=e.elem,n=e.text,a=e.start,r=e.end,i=e.nextStart,o=e.nextEnd;t.selectionStart=a,t.selectionEnd=r,document.execCommand("insertText",!1,n),$(t).trigger("input"),t.selectionStart=i,t.selectionEnd=o}function o(e){var t=e.pattern,n=e.text,a=e.start,r=e.end,i=e.isConsequent,o=v({text:n,start:a,end:r}),s=o.value,l=o.start,d=m({text:s,start:a-l,end:r-l,pattern:t,isConsequent:i});if(!d)return{isWrapped:!1};var u=d.value.split(d.unwrappedValue);return h({},d,{isWrapped:!0,realStart:d.start+l,realEnd:d.end+l,prefixLength:u[0].length,suffixLength:u[1].length})}function s(e){var t=e.elem,n=e.start,a=e.end,r=e.prefix,o=e.suffix,s=g({elem:t,start:n,end:a});i({elem:t,text:""+r+s.value+o,start:s.start,end:s.end,nextStart:n+r.length,nextEnd:a+r.length})}function l(e){var t=e.elem,n=e.start,a=e.end,r=e.parsed,o=r.realStart,s=r.realEnd,l=r.unwrappedValue,d=r.prefixLength,u=r.suffixLength;if(!l.length)return void i({elem:t,text:l,start:o,end:s,nextStart:o,nextEnd:o});var c=o+d,f=s-u,p=n-c,m=a-f;p<0&&(m-=p,p=0),m>0&&(m=0),i({elem:t,text:l,start:o,end:s,nextStart:o+p,nextEnd:o+l.length+m})}function d(e){var t=e.elem,n=e.start,a=e.end,r=e.prefix,o=e.suffix,s=g({elem:t,start:n,end:a}),l=s.value,d=void 0;s.value?C.test(s.value)?(l=""+r+s.value+" "+o,d=s.end+r.length+1):(l=r+" "+s.value+o,d=s.start+r.length):(l=r+" "+o,d=n+r.length),i({elem:t,text:l,start:s.start,end:s.end,nextStart:d,nextEnd:d})}function u(e){var t=e.elem,n=e.start,a=e.end,r=e.parsed,i=r.realStart,o=r.unwrappedValue,s=r.prefixLength,d=o.split(" "),u=i+s;d.length>1&&C.test(d[0])?(t.selectionStart=u,t.selectionEnd=u+d[0].length):l({elem:t,start:n,end:a,parsed:r})}function c(e){var t=e.text,n=e.start,r=e.end,i=e.pattern,o=b.filter(function(e){return"block"===e.type}),s=t.split("\n").reduce(function(e,t){var s=e.lastIndex,l=s+t.length;if(!(s<=n&&l>=n||s>=n&&l<=r||s<=r&&l>=r))return h({},e,{lastIndex:l+1});var d=o.reduce(function(e,n){if(e)return e;n.regexp.lastIndex=0;var a=n.regexp.exec(t);if(a){var r=a[0],i=a[1],o=a.index,l=a.index+r.length;return{value:r,wrappedBy:n.name,unwrappedValue:i,prefixLength:r.length-i.length,start:o+s,end:l+s}}},null),u=d||{value:t,start:s,end:l};return i.lastIndex=0,{lines:[].concat(a(e.lines),[u]),lastIndex:l+1,isWrapped:e.isWrapped&&i.test(u.value)}},{lines:[],lastIndex:0,isWrapped:!0});return delete s.lastIndex,s}function f(e){var t=e.elem,n=e.start,r=e.end,o=e.prefix,s=e.pattern,l=e.nextPrefix,d=e.parsed.lines,u=d.reduce(function(e,t){var n=""+o+t.value;return s.lastIndex=0,s.test(t.value)&&l?n=""+l+t.value:t.unwrappedValue&&(n=""+o+t.unwrappedValue),[].concat(a(e),[n])},[]).join("\n"),c=d[0].start,f=d[d.length-1].end,p=n-c,m=r-f;m<c-f&&(m+=c-f-m);var v=c,g=c+u.length;i({elem:t,text:u,start:c,end:f,nextStart:v+p+o.length,nextEnd:g+m})}function p(e){var t=e.elem,n=e.start,r=e.end,o=e.pattern,s=e.parsed.lines,l=s.reduce(function(e,t){return o.lastIndex=0,[].concat(a(e),[o.test(t.value)?t.unwrappedValue:t.value])},[]).join("\n"),d=s[0].start,u=s[s.length-1].end,c=d+s[0].prefixLength,f=u,p=n-c,m=r-f;p<0&&(p=0),m<c-f&&(m+=c-f-m),i({elem:t,text:l,start:d,end:u,nextStart:d+p,nextEnd:d+l.length+m})}function m(e){var t=e.text,n=e.start,a=e.end,r=e.pattern,i=e.isConsequent,o=void 0,s=[];for(console.log(t,n,a),r.lastIndex=0;null!==(o=r.exec(t));){console.log(o);var l=o[0],d=o[1],u=o.index,c=o.index+l.length;u<=n&&c>=a&&s.push({value:l,unwrappedValue:d,start:u,end:c}),i&&(r.lastIndex=o.index+1)}return s.length?(s.sort(function(e,t){return e.value.length-t.value.length}),s[0]):null}function v(e){var t=e.text,n=e.start,a=e.end;for(n-=1;"\n"!==t[n]&&n>0;)n--;for(0!==n&&n++;"\n"!==t[a]&&a<t.length;)a++;return{value:t.substring(n,a),start:n,end:a}}function g(e){var t=e.elem,n=e.start,a=e.end,r=n,i=a,o=t.value.substr(n,a-n);if(n===a){var s=v({text:t.value,start:n,end:a}),l=s.value,d=s.start,u=m({text:l,start:n-d,end:a-d,pattern:/[^\s]+/g});u&&(r=u.start+d,i=u.end+d,o=u.value)}return{start:r,end:i,value:o}}Object.defineProperty(t,"__esModule",{value:!0});var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},x=n(3),y={type:"inline",parse:o,wrap:s,unwrap:l},w={type:"block",parse:c,wrap:f,unwrap:p},b=[h({},y,{name:"bold",keys:"Cmd+B",regexp:/\*\*([^\s]{0,2}|[^\s].*?[^\s])\*\*/g,prefix:"**",suffix:"**"}),h({},y,{name:"italic",keys:"Cmd+I",regexp:/\/\/([^\s]{0,2}|[^\s].*?[^\s])\/\//g,prefix:"//",suffix:"//"}),h({},y,{name:"link",keys:"Cmd+K",regexp:/\(\(\s*(.*?)\s*\)\)/g,prefix:"((",suffix:"))",wrap:d,unwrap:u}),h({},w,{name:"header",keys:"Cmd+Alt+1",regexp:/^[^\S\n]*#[^\S\n]*([^#].*)$/g,prefix:"# "}),h({},w,{name:"subheader",keys:"Cmd+Alt+2",regexp:/^[^\S\n]*##[^\S\n]*([^#].*)$/g,prefix:"## "}),h({},w,{name:"remove headers",keys:"Cmd+Alt+0",regexp:/^[^\S\n]*#{1,2}[^\S\n]*([^#].*)$/g,wrap:p}),h({},w,{name:"increase quote level",keys:"Cmd+]",regexp:/^[^\S\n]*>[^\S\n]*(.*)$/g,prefix:"> ",nextPrefix:">",unwrap:f}),h({},w,{name:"decrease quote level",keys:"Cmd+[",regexp:/^[^\S\n]*>[^\S\n]*(.*)$/g,prefix:"> ",wrap:function(){}})],C=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%\/.\w-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[.!\/\\\w]*))?)/;t.default=r},,function(e,t,n){"use strict";function a(e,t){var n=Math.max(Math.min(t,.9),.1),a=Math.floor(245-245*n);e.style.strokeDashoffset=a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e,t,n,a,r){if(window.FormData){var i=new window.FormData;i.append("file",e),$.ajax({type:"POST",timeout:0,url:t,data:i,cache:!1,contentType:!1,processData:!1,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",n,!1),e},success:a,error:r})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(0),i=n(16),o=a(i),s=n(7),l=a(s),d=n(1),u=a(d),c=n(17),f=a(c),p=n(18),m=a(p),v=n(19),g=a(v),h=n(20),x=a(h),y=n(21),w=a(y),b=n(22),C=a(b),_=n(8),E=a(_),S=n(23),O=a(S);"undefined"!=typeof $&&$(function(){(0,o.default)(),(0,m.default)(),(0,f.default)(),(0,g.default)(),(0,O.default)(),(0,x.default)(),(0,w.default)(),(0,C.default)(),function(){function e(e){var t=e.originalEvent.dataTransfer;if(t&&(!t.types.contains||t.types.contains("Files"))&&(!t.types.indexOf||-1!==t.types.indexOf("Files"))){t.dropEffect&&(t.dropEffect="copy");var n=$(this);return n.addClass("e2-external-drop-target-dragover"),n.hasClass("e2-external-drop-target-altable")&&e.altKey?n.addClass("e2-external-drop-target-dragover-alt"):n.removeClass("e2-external-drop-target-dragover-alt"),!1}}function t(){var e=$(this);return e.removeClass("e2-external-drop-target-dragover"),e.removeClass("e2-external-drop-target-dragover-alt"),!1}function n(e){var t=$(this),n=t.find("img"),a=e.originalEvent.dataTransfer;if(a||a.files){if(1===a.files.length){var r=a.files[0],i=$(".e2-user-picture-uploading circle.e2-progress")[0],o="e2-user-picture-container-uploading";(0,u.default)(t,1),t.addClass(o),(0,E.default)(r,$(".e2-userpic-upload-action").attr("href"),function(e){e.lengthComputable&&(0,l.default)(i,e.loaded/e.total)},function(e,a,r){if(e=JSON.parse(e),(0,l.default)(i,0),(0,u.default)(t,0),e.success){var s=e.data["new-image-src"];n.attr("src",s+"?"+encodeURIComponent(new Date)),n.on("load",function(){return t.removeClass(o)}),$(".e2-set-userpic-by-dragging").slideUp(333)}else t.removeClass(o)},function(e,t,n){(0,l.default)(i,0)})}return!1}}$(".e2-external-drop-target").on("dragover dragenter",e).on("dragleave drop",t),$(".e2-user-picture-container").on("drop",n),function(){if(r.isLocalStorageAvailable){var e=$("#e2-drafts-item"),t=e.find(".e2-unsaved-led"),n=$("#e2-new-note-item .e2-unsaved-led"),a=$("#e2-notes-unsaved"),i=$("#e2-nothing-message"),o=$("#form-note"),s=document.e2.localCopies.getList(),l=document.e2.localCopies.doesCopyExist("new"),d=o?$("#note-id").val():null,u="new"!==d&&document.e2.localCopies.doesCopyExist(d),c=Object.keys(s).length;if(l&&c--,u&&c--,t&&c>0&&(e.show(),t.show()),n&&l&&n.show(),a&&i){var f=document.e2.localCopies.getName("new");s.hasOwnProperty(f)&&delete s[f];for(var p in s)"false"===s[p].isPublished&&($("#e2-draft-"+p+" .e2-unsaved-led").show(),delete s[p]);if(Object.keys(s).length){for(var m in s){var v=document.e2.localCopies.get(m);if(v){var g=$("#e2-unsaved-note-prototype").clone(!0);g.attr("id",null),$(".e2-admin-link",g).attr("href",v.link),$("u",g).html(v.title),g.attr("style",""),a.append(g)}}a.show(),i.hide()}}}}()}(),function(){var e=function(e,t){t?(e.addClass("e2-admin-item_thinking"),(0,u.default)(e,1)):((0,u.default)(e,0),e.removeClass("e2-admin-item_thinking"))},t=function(e,t){t?e.addClass("e2-admin-item_disabled e2-popup-menu-widget-item_disabled"):e.removeClass("e2-admin-item_disabled e2-popup-menu-widget-item_disabled")},n=function(n,a,r){return!!n.hasClass("e2-admin-item_disabled")||!!n.hasClass("e2-popup-menu-widget-item_disabled")||(n.removeClass("e2-admin-item_on"),e(n,1),t(n,1),void $.ajax({type:"post",timeout:1e4,url:n.attr("href"),data:"result=ajaxresult",success:function(e){e=JSON.parse(e),e.success&&(e.data["flag-now-on"]?(n.addClass("e2-admin-item_on"),a(e.data["new-href"],n)):(n.removeClass("e2-admin-item_on"),r(e.data["new-href"],n)))},error:function(){window.location.href=n.attr("href")},complete:function(){e(n,0),t(n,0)}}))},a=function(e){var t={"toggle-favourite":function(){n(e,function(e,t){t.attr("href",e).parents(".e2-note").addClass("e2-note-favourite")},function(e,t){t.attr("href",e).parents(".e2-note").removeClass("e2-note-favourite")})},"toggle-pinned":function(){n(e,function(e,t){t.attr("href",e)},function(e,t){t.attr("href",e)})},"toggle-important":function(){n(e,function(e,t){t.attr("href",e).parents(".e2-comment, .e2-comment-form-meta-area").find(".e2-comment-piece-markable").addClass("e2-comment-piece-marked")},function(e,t){t.attr("href",e).parents(".e2-comment, .e2-comment-form-meta-area").find(".e2-comment-piece-markable").removeClass("e2-comment-piece-marked")})},"removed-href":function(){n(e,function(e,t){},function(e,t){var n=t.parents(".e2-comment");n.find(".e2-comment-author").addClass("e2-comment-author-removed"),n.find(".e2-comment-meta, .e2-comment-content").slideUp(333),n.hasClass(".e2-reply")||n.siblings(".e2-reply").slideUp(333),t.trigger("E2_ADMIN_COUPLE_CHANGE_ITEM",{response:"removed"})})},"replaced-href":function(){n(e,function(e,t){var n=t.parents(".e2-comment");n.find(".e2-comment-content, .e2-comment-meta").slideDown(333),n.find(".e2-comment-author").removeClass("e2-comment-author-removed"),n.hasClass(".e2-reply")||n.siblings(".e2-reply").slideDown(333),t.trigger("E2_ADMIN_COUPLE_CHANGE_ITEM",{response:"recovered"})},function(e,t){})},"couple-trigger":function(){e.trigger("E2_ADMIN_COUPLE_WILL_THINK")}},a=!0,r=e.data("e2-js-action");return r&&$.each(r.split(","),function(e,n){"function"==typeof t[n]&&(a=!1,t[n]())}),a};$(".e2-admin-item").add(".e2-popup-menu-widget-item").on("click",function(){return a($(this))})}(),function(){var e=function(e){if(e.length){var t=e.find(".e2-admin-couple-item");e.find('[data-e2-js-action*="couple-trigger"]').on("E2_ADMIN_COUPLE_CHANGE_ITEM",function(n,a){void 0!==a.response&&((0,u.default)(e.find(".e2-admin-couple-spinner"),0),t.addClass("e2-admin-couple-item_hidden"),e.find(".e2-admin-couple-item_"+a.response).removeClass("e2-admin-couple-item_hidden"),e.removeClass("e2-admin-couple_thinking"))}).on("E2_ADMIN_COUPLE_WILL_THINK",function(){(0,u.default)(e.find(".e2-admin-couple-spinner"),1),e.addClass("e2-admin-couple_thinking")})}};$(".e2-admin-couple").each(function(){e($(this))}),$(document).on("E2_ADMIN_COUPLE_INIT",function(t,n){void 0!==n.$couple&&e(n.$couple)})}()})},function(e,t,n){"use strict";function a(){r.isLocalStorageAvailable&&(document.e2.localCopies={_lsKey:"copies-info",_lsPrefix:"copy-",_cookieName:document.e2.cookiePrefix+"local_copies",getListName:function(){return this._lsKey},getPrefix:function(){return this._lsPrefix},getName:function(e){return this._lsPrefix+e},save:function(e,t){r.localStorage.setItem(this.getName(e),JSON.stringify(t)),this.addToList(e,t)},remove:function(e){r.localStorage.removeItem(this.getName(e)),this.removeFromList(e)},get:function(e,t,n){var a=!1;try{if(!(a=JSON.parse(r.localStorage.getItem(this.getName(e)))))return!1}catch(e){return!1}return n&&t&&this.isCopyOutdated(a,t,n)?(this.remove(e),!1):a},getList:function(){try{return JSON.parse(r.localStorage.getItem(this._lsKey))||{}}catch(e){return{}}},addToList:function(e,t){var n=this.getList();n.hasOwnProperty(e)||(n[e]={isPublished:t.isPublished,timestamp:t.timestamp},r.localStorage.setItem(this._lsKey,JSON.stringify(n)),this.updateCookie(n))},removeFromList:function(e){var t=this.getList();t.hasOwnProperty(e)&&(delete t[e],r.localStorage.setItem(this._lsKey,JSON.stringify(t)),this.updateCookie(t))},doesCopyExist:function(e){return r.localStorage.hasOwnProperty(this.getName(e))},isCopyOutdated:function(e,t,n){if(!t||!n)return!1;var a=+e.timestamp,r=(new Date).getTime(),i=n-r;return Math.abs(i)>216e6&&(t-=i),a<=t},checkOutdatedCopies:function(){var e=document.e2.noteLastModifiedsById||{},t=this.getList();for(var n in t)"new"!==n&&(e.hasOwnProperty(n)?this.isCopyOutdated(t[n],1e3*e[n],1e3*document.e2.serverTime)&&this.remove(n):this.remove(n))},generateCookie:function(){document.cookie.match(new RegExp("(?:^|; )"+this._cookieName.replace(/([.$?*|{}()[]\\\/\+^])/g,"\\$1")+"=([^;]*)"))||this.updateCookie()},updateCookie:function(e){e=e||this.getList();var t=[];for(var n in e)"new"!==n&&t.push(n);if(t.length)document.cookie=this._cookieName+"="+t.join(",")+";path=/";else{var a=new Date;a.setTime(a.getTime()-1),document.cookie=this._cookieName+'="";path=/;expires='+a.toUTCString()}}},document.e2.localCopies.checkOutdatedCopies(),document.e2.localCopies.generateCookie())}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);document.e2=document.e2||{},t.default=a},function(e,t,n){"use strict";function a(){var e=$(".e2-note");e.length&&r.isLocalStorageAvailable&&function(e){for(var t=0;t<e.length;t++){var n=e[t].id.replace("e2-note-","");document.e2.localCopies.doesCopyExist(n)&&$("#e2-note-"+n+" .e2-unsaved-led").show()}}(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=a},function(e,t,n){"use strict";function a(){function e(){E||(l.off("ajaxError",e),S=setInterval(o,3e3),window.addEventListener("beforeunload",o),window.addEventListener("pagehide",n),l.on("submit",t).on("ajaxError",e),m.on("input",a),E=!0)}function t(){clearInterval(S),n(),window.removeEventListener("pagehide",n),l.off("submit",t),m.off("input",a),E=!1}function n(){window.removeEventListener("beforeunload",o)}function a(){m[0].selectionEnd&&(_=m[0].selectionEnd)}function i(){var e=document.e2.localCopies.get(d.val(),y,w);if(e){e.caretPosition&&m.one("autosized",function(){if("function"==typeof window.getCaretCoordinates){var t=window.getCaretCoordinates(m[0],e.caretPosition);window.scrollTo(0,m.position().top+t.top-15)}}),document.queryCommandSupported("insertText")?(p.focus().select(),document.execCommand("insertText",!1,e.title),p.trigger("input"),m.focus().select(),document.execCommand("insertText",!1,e.text),m.trigger("input")):(p.val(e.title).trigger("input"),m.val(e.text).trigger("input"));var t=e.tags?e.tags.slice():[];if(t.length&&v.find("option").each(function(e,n){var a=t.indexOf(n.text);a>-1&&t.splice(a,1)}),t.length){var n=void 0,a=function e(){if(!v.hasClass("chzn-done"))return void(n=setTimeout(e,500));clearTimeout(n);var a=$("#tags_chzn .search-field input");t.forEach(function(e){a.val(e+","),a.trigger({type:"keyup",which:191})})};n=setTimeout(a,500)}v.val(e.tags).trigger("input"),x.empty().html(e.images.reduce(function(e,t){return void 0!==t.src&&t.src?e+'<div class="e2-uploaded-image"><div class="e2-uploaded-image-inner"><img src="'+t.src+'" alt="'+t.alt+'" width="'+t.width+'" height="'+t.height+'"></div></div>':""},"")),(e.alias&&g.val()!==e.alias||h.val()!==e.stamp)&&(g.val(e.alias),h.val(e.stamp),$(".e2-note-time-and-url").slideToggle()),c.show(),f.show(),e.caretPosition&&(m.focus(),m[0].selectionStart=m[0].selectionEnd=_=e.caretPosition)}}function o(){var e=c.is(":visible");if(e||C){C=e;var t=s();if(!t.images.length&&!t.title.trim()&&!t.text.trim())return void document.e2.localCopies.remove(t.id);document.e2.localCopies.save(t.id,t)}}function s(){for(var e=x.find(".e2-uploaded-image"),t=d.val(),n=p.val(),a=m.val(),r=[],i=void 0,o=0;o<e.length;o++)i=e.eq(o).find("img"),r.push({src:i.attr("src"),alt:i.attr("alt"),width:i.width(),height:i.height()});return{id:t,title:n,text:a,tags:v.val(),images:r,alias:"new"!==b&&g.val(),stamp:h.val(),timestamp:(new Date).getTime(),link:window.location.pathname,isPublished:u.val(),caretPosition:_}}var l=$("#form-note");if(r.isLocalStorageAvailable&&l){var d=$("#note-id"),u=$("#is-note-published"),c=$("#livesave-button"),f=$("#livesave-button + .e2-unsaved-led"),p=$("#title"),m=$("#text"),v=$("#tags"),g=$("#alias"),h=$("#stamp"),x=$("#e2-uploaded-images"),y=1e3*+$("#note-timestamp").val(),w=1e3*+$("#server-time").val(),b=d.val(),C=c.is(":visible"),_=null,E=!1,S=null;document.e2.localCopies.loadLocalCopy=i,document.e2.localCopies.initLocalSaver=e,document.e2.localCopies.destroyLocalSaver=t}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=a},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){function e(e){e=e||{},$.ajax({data:c.serialize(),url:c.find("#e2-note-livesave-action").attr("href"),success:function(t){e.onAjaxSuccess&&e.onAjaxSuccess();var n;try{n=JSON.parse(t)}catch(t){return void(e.onError&&e.onError(t.message))}if("created"===n.status){var a=n.id;window.history.replaceState&&(window.history.replaceState(null,"",n["note-edit-url"]),$(".e2-admin-menu-new-selected").hide(),$(".e2-admin-menu-new").show()),f.val(a),r(),e.onCreated&&e.onCreated(n),m=null}else"saved"===n.status?($("#alias").val(n["new-alias"]),window.history.replaceState&&window.history.replaceState(null,"",n["note-edit-url"]),r(),e.onSaved&&e.onSaved(n),m=null):"error"===n.status&&e.onError&&e.onError(n.message)},error:function(t){e.onAjaxError&&e.onAjaxError(t.responseText)},complete:function(t){e.onAjaxComplete&&e.onAjaxComplete()}})}function t(){$("#stamp").val()&&w.test($("#stamp").val()),/^ *$/.test($("#title").val())||/^ *$/.test($("#text").val())||y?p.prop("disabled",!0):p.prop("disabled",!1)}function n(e){(0,o.default)($("#livesaving"),0),$("#livesaving").hide(),$("#livesave-button, #livesave-button + .e2-unsaved-led").show(),$("#livesave-error").removeClass("e2-save-error_hidden"),$("#livesave-error").attr("title",e)}function a(){if(!y){var a=i();if(""!==a.text){if(y=!0,t(),""===a.title){var r,s=a.text;(r=s.indexOf("."))>=0&&(s=s.substr(0,r)),(r=s.indexOf(";"))>=0&&(s=s.substr(0,r)),(r=s.indexOf(","))>=0&&(s=s.substr(0,r)),(r=s.indexOf(")"))>=0&&(s=s.substr(0,r)),0===s.indexOf("((")&&(s=s.substr(2)),s=s.substr(0,1).toUpperCase()+s.substr(1),$("#title").val(s).change()}$("#livesave-button, #livesave-button + .e2-unsaved-led, #livesave-error").hide(),$("#livesaving").fadeIn(333),(0,o.default)($("#livesaving"),1),e({onCreated:function(){v=a,$("#e2-drafts")&&$("#e2-drafts-item")&&($("#e2-drafts-item").fadeIn(333),$('<div class="e2-admin-menu-item-frame"></div>').css({position:"absolute",left:$("#e2-note-form-wrapper").offset().left,top:$("#e2-note-form-wrapper").offset().top,width:$("#e2-note-form-wrapper").width(),height:$("#e2-note-form-wrapper").height()}).appendTo("body").animate({left:$("#e2-drafts").offset().left-10,top:$("#e2-drafts").offset().top-5,width:$("#e2-drafts").width()+20,height:$("#e2-drafts").height()+10},667).fadeTo(333,.667).fadeOut(333),$("#e2-drafts-count").html(1*$("#e2-drafts-count").html()+1))},onSaved:function(){v=a},onError:n,onAjaxSuccess:function(){(0,o.default)($("#livesaving"),0),$("#livesaving").fadeOut(333)},onAjaxError:n,onAjaxComplete:function(){y=!1,t()}})}}}function r(){s.isLocalStorageAvailable&&(m?document.e2.localCopies.remove(m):document.e2.localCopies.remove(f.val()),document.e2.localCopies.destroyLocalSaver())}function i(){return{title:$("#title").val(),tags:($("#tags").val()||[]).join(),text:$("#text").val(),alias:$("#alias").val(),stamp:$("#stamp").val()}}function d(e,t){return JSON.stringify(e)===JSON.stringify(t)}var c=$("#form-note");if(c.length){var f=c.find("#note-id"),p=c.find("#submit-button"),m=f.val(),v=i(),g=v?Object.assign({},v):i(),h=!1,x=!1,y=!1,w=/^ *(\d{1,2})\.(\d{1,2})\.(\d{2}|\d{4}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/;$(window).bind("pageshow",function(e){e.originalEvent.persisted&&window.location.reload()}),document.e2.localCopies.initLocalSaver&&document.e2.localCopies.loadLocalCopy&&(document.e2.localCopies.loadLocalCopy(),document.e2.localCopies.initLocalSaver()),$.ajaxSetup({type:"post",timeout:1e4}),c.on("submit",function(n){function a(e){v=s,(0,o.default)($("#note-saving"),0),$("#note-saving").hide(),$("#note-saved").fadeIn(333),window.location.href=e["note-url"]}function r(e){c.trigger("ajaxError"),(0,o.default)($("#note-saving"),0),$("#note-saving").hide(),$("#submit-keyboard-shortcut").show(),$("#note-save-error").show(),$("#note-save-error").attr("title",e)}n.preventDefault();var s=i();y=!0,t(),$("#submit-keyboard-shortcut, #note-save-error").hide(),(0,o.default)($("#note-saving"),1),$("#note-saving").show(),e({onCreated:a,onSaved:a,onError:r,onAjaxError:r,onAjaxComplete:function(){y=!1,t()}})}),$("#title").bind("input",function(){$("#alias").attr("placeholder","")});var b="change input keyup keydown keypress mouseup mousedown cut copy paste blur",C=function(){$("#stamp").val()&&$("#stamp").toggleClass("input-error",null===$("#stamp").val().match(w)),t();var e=i();h=!d(g,e),x=!v||!d(v,e);var n=$("#livesave-button, #livesave-button + .e2-unsaved-led");h&&x&&""!==e.text?(h=!1,$("#livesaving").hide(),document.e2.localCopies.initLocalSaver(),n.fadeIn(333),g=Object.assign({},e)):x||(x=!1,r(),n.fadeOut(333),g=Object.assign({},e));var a=e.title.trim(),o=e.text.trim();$("#e2-uploaded-images .e2-uploaded-image").length||a||o||!n.is(":visible")||n.fadeOut(333)};$("#title").add("#tags").add("#text").add("#alias").add("#stamp").on(b,C),$("#tags").on("liszt:ready",function(){$("#tags_chzn .search-field").on(b,C)}),$("#title").on("keydown",function(e){13===e.keyCode&&$("#text").focus()}),$("#livesave-button").on("click",function(){return a(),!1}),u.default.mac?(0,l.bindKeys)("Cmd+S",a,{prevent:!0}):(0,l.bindKeys)("Ctrl+S",a,{prevent:!0}),$("#text").is(":focus")||$("#title").attr("autofocus",!0).focus().val($("#title").val()),t()}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=a(i),s=n(0),l=n(3),d=n(2),u=a(d);t.default=r},function(e,t,n){"use strict";function a(){$("#form-note-publish").length&&($(".e2-schedule-controls-revealer").on("click",function(){$(".e2-publish-now-controls").hide(),$(".e2-schedule-controls").show(),$(".e2-post-time-control").slideDown(333,function(){$(".e2-schedule-controls button").prop("disabled",!1)});var e=new Date,t=e.getDate();t<10&&(t="0"+t);var n=e.getMonth()+1;n<10&&(n="0"+n);var a=e.getFullYear(),r=e.getHours(),i=e.getMinutes();return r+=1,59===i&&(r+=1),r<10&&(r="0"+r),$("#stamp").val(t+"."+n+"."+a+" "+r+":00:00"),$("#stamp").trigger("change"),!1}),$(".e2-schedule-controls-unrevealer").on("click",function(){return $(".e2-schedule-controls").hide(),$(".e2-schedule-controls button").prop("disabled",!0),$(".e2-post-time-control").slideUp(333),$(".e2-publish-now-controls").show(),!1}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(){$("#form-preferences").length&&((0,i.default)(document.getElementById("blog-description")),$("#e2-template-selector").show(),$("#blog-title").bind("input blur cut copy paste keypress",function(){var e=$("#e2-blog-title");e&&e.text(this.value?this.value:$("#e2-blog-title-default").val())}),$("#blog-author").bind("input blur cut copy paste keypress",function(){var e=$("#e2-blog-author");e&&e.text(this.value?this.value:$("#e2-blog-author-default").val())}),$("#notes-per-page").bind("change blur",function(){parseInt(this.value)!==parseInt(this.value)&&(this.value=10),this.value=Math.min(Math.max(this.value,3),100)}),$("#email-notify").bind("change",function(){$("#email").focus()}),$("#email").bind("input change blur",function(){this.value||$("#email-notify").removeAttr("checked")}),$(".e2-template-preview").click(function(){var e=$(this);$(".e2-template-preview").attr("class","e2-template-preview"),e.addClass("e2-current-template-preview"),$("#template").val(e.attr("value")),$(".e2-template-preview-link").attr("href",e.data("preview-url"))}))}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=a},function(e,t,n){"use strict";function a(){function e(){/^ *$/.test($("#tag").val())||/^ *$/.test($("#urlname").val())?n.prop("disabled",!0):n.prop("disabled",!1)}var t=$("#form-tag");if(!t.length){var n=t.find("#submit-button");$.ajaxSetup({type:"post",timeout:1e4}),$(".required").bind("input blur cut copy paste keypress",e),e()}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){function e(e,t,n,a,r){var i=$("#e2-uploaded-image-prototype").clone(!0),o=i.find(".e2-uploaded-image-inner_good"),s=o.find("img"),l=i.find(".e2-uploaded-image-inner_bad"),u=l.find(".e2-uploaded-image-noimage"),c=i.find(".e2-popup-menu");return i.removeAttr("id").attr("style","").data("file",t).css("width",""),i.addClass("e2-uploaded-image_active"),c.find(".e2-image-popup-menu-filename").text(t).attr("title",t),a&&r?(l.remove(),s.attr("src",e+"?"+(new Date).getTime()).attr("alt",t).attr("width",a).attr("height",r),c.find(".e2-image-popup-menu-filesize").text(n)):(o.remove(),u.attr("data-src",e),c.find(".e2-popup-menu-widget-item").filter(":not(.e2-popup-menu-widget-item_info):not(.e2-popup-menu-widget-item_remove)").addClass("e2-popup-menu-widget-item_disabled")),$(document).trigger("E2_ADMIN_ITEM_WITH_POPUP_MENU_INIT",{$popupMenu:c}),-1===$.inArray(t,d)&&d.push(t),i}function t(t,a,r){if(a=JSON.parse(a),a.success){c+=t.size;var i=$('#e2-uploaded-images img[src="'+a.thumb+'"], #e2-uploaded-images img[src^="'+a.thumb+'?"], #e2-uploaded-images .e2-uploaded-image-noimage[data-src="'+a.thumb+'"], #e2-uploaded-images .e2-uploaded-image-noimage[data-src^="'+a.thumb+'?"]'),o=i.parents(".e2-uploaded-image");if(a.overwrite)(0,l.default)(C,0),C.addClass(E),w.removeClass(_),i.length&&(e(a.thumb,a["new-name"],a.filesize,a.width,a.height).insertAfter(o),o.remove());else{r&&(0,m.default)(a["new-name"]);-1!==$.inArray(a["new-name"],d)?((0,l.default)(C,0),C.addClass(E),w.removeClass(_),i.length&&(e(a.thumb,a["new-name"],a.filesize,a.width,a.height).insertAfter(o),o.remove())):e(a.thumb,a["new-name"],a.filesize,a.width,a.height).appendTo(v).show(333,function(){(0,l.default)(C,0),C.addClass(E),w.removeClass(_)})}}else(0,l.default)(C,0),C.addClass(E),w.removeClass(_),"could-not-create-thumbnail"===a.error?$("#e2-upload-error-cannot-create-thumbnail").slideDown(333):$("#e2-upload-error-cannot-upload").slideDown(333);n()}function n(){if(s.length){var e=C.find("circle.e2-progress")[0],n=s.shift(),a=n.name,r=$("#e2-file-upload-action").attr("href")+"?";void 0!==$("#note-id").val()?r+="entity=note&entity-id="+$("#note-id").val():void 0!==$("#tag-id").val()?r+="entity=tag&entity-id="+$("#tag-id").val():r=null,r&&n.e2AltKeyPressed&&(r+="&overwrite"),$(".e2-upload-error").slideUp(333);return(0,f.default)(a)?((0,u.default)(e,0),(0,l.default)(C,1),C.removeClass(E),w.addClass(_),(0,g.default)(n,r,function(t){if(t.lengthComputable){var n=(c+t.loaded)/p;(0,u.default)(e,n)}},function(a,r,i){t(n,a,n.e2DroppedIntoTextarea),(0,u.default)(e,0)},function(a,r,i){t(n,'{"success": false, "error": "'+r+'"}',n.e2DroppedIntoTextarea),(0,u.default)(e,0)})):$("#e2-upload-error-unsupported-file").slideDown(333),!1}return p=0,c=0,!0}function a(e){var t=e.originalEvent.dataTransfer;if(t&&t.files){var a="text"===$(e.target).attr("id");s.length=0;for(var r=0;r<t.files.length;r++)t.files[r].e2AltKeyPressed=e.altKey,t.files[r].e2DroppedIntoTextarea=a,s.push(t.files[r]),c=0,p+=t.files[r].size;return n(),!1}}function r(e){if(!e.target.files.length)return!1;s.length=0;for(var t=0;t<e.target.files.length;t++)s.push(e.target.files[t]),c=0,p+=e.target.files[t].size;return n(),!1}if($("#form-tag").length||$("#form-note").length){$(".e2-upload-controls-attach").length>0&&$(document.body).addClass("e2-external-drop-target e2-external-drop-target-body e2-external-drop-target-altable");var i=(0,o.default)(),s=[],d=[],c=0,p=0,v=$("#e2-uploaded-images"),h=v.find(".e2-uploaded-image"),y=$(".e2-upload-controls"),w=y.find(".e2-upload-controls-attach"),b=w.find(".e2-upload-controls-attach-input"),C=y.find(".e2-upload-controls-uploading"),_="e2-upload-controls-attach_hidden",E="e2-upload-controls-uploading_hidden";v.on("click",'[data-e2-js-action*="remove-image"]',function(e){var t=$(e.currentTarget).parents(".e2-uploaded-image"),n=t.data("file");return t.addClass("e2-uploaded-image_deleting"),(0,x.default)(n).done(function(e){"error|"===e.substr(0,6)?t.removeClass("e2-uploaded-image_deleting"):(d.splice($.inArray(n,d),1),i?(t.off(i+".e2Delfiles").on(i+".e2Delfiles",function(){t.remove()}),t.addClass("e2-uploaded-image_deleted")):t.remove())}).fail(function(){t.removeClass("e2-uploaded-image_deleting")}),!1}).on("click",'[data-e2-js-action*="paste-image"]',function(e){var t=$(e.currentTarget);return(0,m.default)(t.parents(".e2-uploaded-image").data("file")),!1}),h.length&&v.html(function(){var t=[];return h.each(function(){var n,a,r,i,o,s=$(this),l=s.find("img"),d=s.find(".e2-uploaded-image-noimage");l.length?(n=l.attr("src"),a=l.data("filename"),r=l.data("filesize"),i=l.attr("width"),o=l.attr("height")):(n=d.data("src"),a=d.data("filename")),t.push(e(n,a,r,i,o))}),t}()),y.removeClass("e2-upload-controls_hidden"),b.on("change",r),$(".e2-external-drop-target-body, .e2-external-drop-target-textarea").on("drop",a)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(24),o=a(i),s=n(1),l=a(s),d=n(7),u=a(d),c=n(25),f=a(c),p=n(26),m=a(p),v=n(8),g=a(v),h=n(27),x=a(h);t.default=r},function(e,t,n){"use strict";function a(){var e,t=document.createElement("div"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e];return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e){var t="",n=e.lastIndexOf(".");return-1!==n&&(t=e.substr(n+1)),/^gif|jpe?g|png|svg|mp3$/i.test(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e){var t="";if("calliope"===$("#formatter-id").val()&&(t="(("+e+"))"),"neasden"===$("#formatter-id").val()&&(t=e+""),t){var n=document.getElementById("text");if(n.focus(),n.selectionStart||"0"===n.selectionStart){var a=n.selectionStart,r=n.selectionEnd,i=t;if(a===r){for(;"\r"!==n.value.charAt(a)&&"\n"!==n.value.charAt(a)&&a>0;)a-=1;for(;"\r"===n.value.charAt(a)||"\n"===n.value.charAt(a);)a+=1;i+="\n\n",r=a}n.value=n.value.substring(0,a)+i+n.value.substring(r,n.value.length),n.selectionStart=n.selectionEnd=a+i.length-2}else n.value+="\r\n\r\n"+t;if("createEvent"in document){var o=document.createEvent("HTMLEvents");o.initEvent("change",!1,!0),n.dispatchEvent(o)}else n.fireEvent("onchange");n.focus()}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e){var t=$("#e2-file-remove-action").attr("href")+"?";if($("#form-note"))t+="entity=note&entity-id="+$("#note-id").val();else{if(!$("#form-tag"))return!1;t+="entity=tag&entity-id="+$("#tag-id").val()}return $.ajax({type:"POST",data:{file:e},timeout:6e4,url:t,contentType:"application/x-www-form-urlencoded"})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}])});